// bignumber@1.1.0 downloaded from https://ga.jspm.io/npm:bignumber@1.1.0/lib/rsa/index.js

var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var i={};var e;var r=0xdeadbeefcafe;var n=15715070==(16777215&r);function BigInteger(t,i,e){null!=t&&("number"==typeof t?this.fromNumber(t,i,e):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))}function nbi(){return new BigInteger(null)}function am1(i,e,r,n,o,s){while(--s>=0){var h=e*(this||t)[i++]+r[n]+o;o=Math.floor(h/67108864);r[n++]=67108863&h}return o}function am2(i,e,r,n,o,s){var h=32767&e,a=e>>15;while(--s>=0){var u=32767&(this||t)[i];var p=(this||t)[i++]>>15;var l=a*u+p*h;u=h*u+((32767&l)<<15)+r[n]+(1073741823&o);o=(u>>>30)+(l>>>15)+a*p+(o>>>30);r[n++]=1073741823&u}return o}function am3(i,e,r,n,o,s){var h=16383&e,a=e>>14;while(--s>=0){var u=16383&(this||t)[i];var p=(this||t)[i++]>>14;var l=a*u+p*h;u=h*u+((16383&l)<<14)+r[n]+o;o=(u>>28)+(l>>14)+a*p;r[n++]=268435455&u}return o}BigInteger.prototype.am=am3;e=28;BigInteger.prototype.DB=e;BigInteger.prototype.DM=(1<<e)-1;BigInteger.prototype.DV=1<<e;var o=52;BigInteger.prototype.FV=Math.pow(2,o);BigInteger.prototype.F1=o-e;BigInteger.prototype.F2=2*e-o;var s="0123456789abcdefghijklmnopqrstuvwxyz";var h=new Array;var a,u;a="0".charCodeAt(0);for(u=0;u<=9;++u)h[a++]=u;a="a".charCodeAt(0);for(u=10;u<36;++u)h[a++]=u;a="A".charCodeAt(0);for(u=10;u<36;++u)h[a++]=u;function int2char(t){return s.charAt(t)}function intAt(t,i){var e=h[t.charCodeAt(i)];return null==e?-1:e}function bnpCopyTo(i){for(var e=(this||t).t-1;e>=0;--e)i[e]=(this||t)[e];i.t=(this||t).t;i.s=(this||t).s}function bnpFromInt(i){(this||t).t=1;(this||t).s=i<0?-1:0;i>0?(this||t)[0]=i:i<-1?(this||t)[0]=i+DV:(this||t).t=0}function nbv(t){var i=nbi();i.fromInt(t);return i}function bnpFromString(i,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e){this.fromRadix(i,e);return}r=2}(this||t).t=0;(this||t).s=0;var n=i.length,o=false,s=0;while(--n>=0){var h=8==r?255&i[n]:intAt(i,n);if(h<0)"-"==i.charAt(n)&&(o=true);else{o=false;if(0==s)(this||t)[(this||t).t++]=h;else if(s+r>(this||t).DB){(this||t)[(this||t).t-1]|=(h&(1<<(this||t).DB-s)-1)<<s;(this||t)[(this||t).t++]=h>>(this||t).DB-s}else(this||t)[(this||t).t-1]|=h<<s;s+=r;s>=(this||t).DB&&(s-=(this||t).DB)}}if(8==r&&0!=(128&i[0])){(this||t).s=-1;s>0&&((this||t)[(this||t).t-1]|=(1<<(this||t).DB-s)-1<<s)}this.clamp();o&&BigInteger.ZERO.subTo(this||t,this||t)}function bnpClamp(){var i=(this||t).s&(this||t).DM;while((this||t).t>0&&(this||t)[(this||t).t-1]==i)--(this||t).t}function bnToString(i){if((this||t).s<0)return"-"+this.negate().toString(i);var e;if(16==i)e=4;else if(8==i)e=3;else if(2==i)e=1;else if(32==i)e=5;else{if(4!=i)return this.toRadix(i);e=2}var r=(1<<e)-1,n,o=false,s="",h=(this||t).t;var a=(this||t).DB-h*(this||t).DB%e;if(h-- >0){if(a<(this||t).DB&&(n=(this||t)[h]>>a)>0){o=true;s=int2char(n)}while(h>=0){if(a<e){n=((this||t)[h]&(1<<a)-1)<<e-a;n|=(this||t)[--h]>>(a+=(this||t).DB-e)}else{n=(this||t)[h]>>(a-=e)&r;if(a<=0){a+=(this||t).DB;--h}}n>0&&(o=true);o&&(s+=int2char(n))}}return o?s:"0"}function bnNegate(){var i=nbi();BigInteger.ZERO.subTo(this||t,i);return i}function bnAbs(){return(this||t).s<0?this.negate():this||t}function bnCompareTo(i){var e=(this||t).s-i.s;if(0!=e)return e;var r=(this||t).t;e=r-i.t;if(0!=e)return e;while(--r>=0)if(0!=(e=(this||t)[r]-i[r]))return e;return 0}function nbits(t){var i=1,e;if(0!=(e=t>>>16)){t=e;i+=16}if(0!=(e=t>>8)){t=e;i+=8}if(0!=(e=t>>4)){t=e;i+=4}if(0!=(e=t>>2)){t=e;i+=2}if(0!=(e=t>>1)){t=e;i+=1}return i}function bnBitLength(){return(this||t).t<=0?0:(this||t).DB*((this||t).t-1)+nbits((this||t)[(this||t).t-1]^(this||t).s&(this||t).DM)}function bnpDLShiftTo(i,e){var r;for(r=(this||t).t-1;r>=0;--r)e[r+i]=(this||t)[r];for(r=i-1;r>=0;--r)e[r]=0;e.t=(this||t).t+i;e.s=(this||t).s}function bnpDRShiftTo(i,e){for(var r=i;r<(this||t).t;++r)e[r-i]=(this||t)[r];e.t=Math.max((this||t).t-i,0);e.s=(this||t).s}function bnpLShiftTo(i,e){var r=i%(this||t).DB;var n=(this||t).DB-r;var o=(1<<n)-1;var s=Math.floor(i/(this||t).DB),h=(this||t).s<<r&(this||t).DM,a;for(a=(this||t).t-1;a>=0;--a){e[a+s+1]=(this||t)[a]>>n|h;h=((this||t)[a]&o)<<r}for(a=s-1;a>=0;--a)e[a]=0;e[s]=h;e.t=(this||t).t+s+1;e.s=(this||t).s;e.clamp()}function bnpRShiftTo(i,e){e.s=(this||t).s;var r=Math.floor(i/(this||t).DB);if(r>=(this||t).t)e.t=0;else{var n=i%(this||t).DB;var o=(this||t).DB-n;var s=(1<<n)-1;e[0]=(this||t)[r]>>n;for(var h=r+1;h<(this||t).t;++h){e[h-r-1]|=((this||t)[h]&s)<<o;e[h-r]=(this||t)[h]>>n}n>0&&(e[(this||t).t-r-1]|=((this||t).s&s)<<o);e.t=(this||t).t-r;e.clamp()}}function bnpSubTo(i,e){var r=0,n=0,o=Math.min(i.t,(this||t).t);while(r<o){n+=(this||t)[r]-i[r];e[r++]=n&(this||t).DM;n>>=(this||t).DB}if(i.t<(this||t).t){n-=i.s;while(r<(this||t).t){n+=(this||t)[r];e[r++]=n&(this||t).DM;n>>=(this||t).DB}n+=(this||t).s}else{n+=(this||t).s;while(r<i.t){n-=i[r];e[r++]=n&(this||t).DM;n>>=(this||t).DB}n-=i.s}e.s=n<0?-1:0;n<-1?e[r++]=(this||t).DV+n:n>0&&(e[r++]=n);e.t=r;e.clamp()}function bnpMultiplyTo(i,e){var r=this.abs(),n=i.abs();var o=r.t;e.t=o+n.t;while(--o>=0)e[o]=0;for(o=0;o<n.t;++o)e[o+r.t]=r.am(0,n[o],e,o,0,r.t);e.s=0;e.clamp();(this||t).s!=i.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){var i=this.abs();var e=t.t=2*i.t;while(--e>=0)t[e]=0;for(e=0;e<i.t-1;++e){var r=i.am(e,i[e],t,2*e,0,1);if((t[e+i.t]+=i.am(e+1,2*i[e],t,2*e+1,r,i.t-e-1))>=i.DV){t[e+i.t]-=i.DV;t[e+i.t+1]=1}}t.t>0&&(t[t.t-1]+=i.am(e,i[e],t,2*e,0,1));t.s=0;t.clamp()}function bnpDivRemTo(i,e,r){var n=i.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t){null!=e&&e.fromInt(0);null!=r&&this.copyTo(r)}else{null==r&&(r=nbi());var s=nbi(),h=(this||t).s,a=i.s;var u=(this||t).DB-nbits(n[n.t-1]);if(u>0){n.lShiftTo(u,s);o.lShiftTo(u,r)}else{n.copyTo(s);o.copyTo(r)}var p=s.t;var l=s[p-1];if(0!=l){var f=l*(1<<(this||t).F1)+(p>1?s[p-2]>>(this||t).F2:0);var g=(this||t).FV/f,b=(1<<(this||t).F1)/f,c=1<<(this||t).F2;var v=r.t,m=v-p,d=null==e?nbi():e;s.dlShiftTo(m,d);if(r.compareTo(d)>=0){r[r.t++]=1;r.subTo(d,r)}BigInteger.ONE.dlShiftTo(p,d);d.subTo(s,s);while(s.t<p)s[s.t++]=0;while(--m>=0){var y=r[--v]==l?(this||t).DM:Math.floor(r[v]*g+(r[v-1]+c)*b);if((r[v]+=s.am(0,y,r,m,0,p))<y){s.dlShiftTo(m,d);r.subTo(d,r);while(r[v]<--y)r.subTo(d,r)}}if(null!=e){r.drShiftTo(p,e);h!=a&&BigInteger.ZERO.subTo(e,e)}r.t=p;r.clamp();u>0&&r.rShiftTo(u,r);h<0&&BigInteger.ZERO.subTo(r,r)}}}}function bnMod(i){var e=nbi();this.abs().divRemTo(i,null,e);(this||t).s<0&&e.compareTo(BigInteger.ZERO)>0&&i.subTo(e,e);return e}function Classic(i){(this||t).m=i}function cConvert(i){return i.s<0||i.compareTo((this||t).m)>=0?i.mod((this||t).m):i}function cRevert(t){return t}function cReduce(i){i.divRemTo((this||t).m,null,i)}function cMulTo(t,i,e){t.multiplyTo(i,e);this.reduce(e)}function cSqrTo(t,i){t.squareTo(i);this.reduce(i)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if((this||t).t<1)return 0;var i=(this||t)[0];if(0==(1&i))return 0;var e=3&i;e=e*(2-(15&i)*e)&15;e=e*(2-(255&i)*e)&255;e=e*(2-((65535&i)*e&65535))&65535;e=e*(2-i*e%(this||t).DV)%(this||t).DV;return e>0?(this||t).DV-e:-e}function Montgomery(i){(this||t).m=i;(this||t).mp=i.invDigit();(this||t).mpl=32767&(this||t).mp;(this||t).mph=(this||t).mp>>15;(this||t).um=(1<<i.DB-15)-1;(this||t).mt2=2*i.t}function montConvert(i){var e=nbi();i.abs().dlShiftTo((this||t).m.t,e);e.divRemTo((this||t).m,null,e);i.s<0&&e.compareTo(BigInteger.ZERO)>0&&(this||t).m.subTo(e,e);return e}function montRevert(t){var i=nbi();t.copyTo(i);this.reduce(i);return i}function montReduce(i){while(i.t<=(this||t).mt2)i[i.t++]=0;for(var e=0;e<(this||t).m.t;++e){var r=32767&i[e];var n=r*(this||t).mpl+((r*(this||t).mph+(i[e]>>15)*(this||t).mpl&(this||t).um)<<15)&i.DM;r=e+(this||t).m.t;i[r]+=(this||t).m.am(0,n,i,e,0,(this||t).m.t);while(i[r]>=i.DV){i[r]-=i.DV;i[++r]++}}i.clamp();i.drShiftTo((this||t).m.t,i);i.compareTo((this||t).m)>=0&&i.subTo((this||t).m,i)}function montSqrTo(t,i){t.squareTo(i);this.reduce(i)}function montMulTo(t,i,e){t.multiplyTo(i,e);this.reduce(e)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==((this||t).t>0?1&(this||t)[0]:(this||t).s)}function bnpExp(i,e){if(i>4294967295||i<1)return BigInteger.ONE;var r=nbi(),n=nbi(),o=e.convert(this||t),s=nbits(i)-1;o.copyTo(r);while(--s>=0){e.sqrTo(r,n);if((i&1<<s)>0)e.mulTo(n,o,r);else{var h=r;r=n;n=h}}return e.revert(r)}function bnModPowInt(t,i){var e;e=t<256||i.isEven()?new Classic(i):new Montgomery(i);return this.exp(t,e)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var t=nbi();this.copyTo(t);return t}function bnIntValue(){if((this||t).s<0){if(1==(this||t).t)return(this||t)[0]-(this||t).DV;if(0==(this||t).t)return-1}else{if(1==(this||t).t)return(this||t)[0];if(0==(this||t).t)return 0}return((this||t)[1]&(1<<32-(this||t).DB)-1)<<(this||t).DB|(this||t)[0]}function bnByteValue(){return 0==(this||t).t?(this||t).s:(this||t)[0]<<24>>24}function bnShortValue(){return 0==(this||t).t?(this||t).s:(this||t)[0]<<16>>16}function bnpChunkSize(i){return Math.floor(Math.LN2*(this||t).DB/Math.log(i))}function bnSigNum(){return(this||t).s<0?-1:(this||t).t<=0||1==(this||t).t&&(this||t)[0]<=0?0:1}function bnpToRadix(t){null==t&&(t=10);if(0==this.signum()||t<2||t>36)return"0";var i=this.chunkSize(t);var e=Math.pow(t,i);var r=nbv(e),n=nbi(),o=nbi(),s="";this.divRemTo(r,n,o);while(n.signum()>0){s=(e+o.intValue()).toString(t).substr(1)+s;n.divRemTo(r,n,o)}return o.intValue().toString(t)+s}function bnpFromRadix(i,e){this.fromInt(0);null==e&&(e=10);var r=this.chunkSize(e);var n=Math.pow(e,r),o=false,s=0,h=0;for(var a=0;a<i.length;++a){var u=intAt(i,a);if(u<0)"-"==i.charAt(a)&&0==this.signum()&&(o=true);else{h=e*h+u;if(++s>=r){this.dMultiply(n);this.dAddOffset(h,0);s=0;h=0}}}if(s>0){this.dMultiply(Math.pow(e,s));this.dAddOffset(h,0)}o&&BigInteger.ZERO.subTo(this||t,this||t)}function bnpFromNumber(i,e,r){if("number"==typeof e)if(i<2)this.fromInt(1);else{this.fromNumber(i,r);this.testBit(i-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(i-1),op_or,this||t);this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(e)){this.dAddOffset(2,0);this.bitLength()>i&&this.subTo(BigInteger.ONE.shiftLeft(i-1),this||t)}}else{var n=new Array,o=7&i;n.length=(i>>3)+1;e.nextBytes(n);o>0?n[0]&=(1<<o)-1:n[0]=0;this.fromString(n,256)}}function bnToByteArray(){var i=(this||t).t,e=new Array;e[0]=(this||t).s;var r=(this||t).DB-i*(this||t).DB%8,n,o=0;if(i-- >0){r<(this||t).DB&&(n=(this||t)[i]>>r)!=((this||t).s&(this||t).DM)>>r&&(e[o++]=n|(this||t).s<<(this||t).DB-r);while(i>=0){if(r<8){n=((this||t)[i]&(1<<r)-1)<<8-r;n|=(this||t)[--i]>>(r+=(this||t).DB-8)}else{n=(this||t)[i]>>(r-=8)&255;if(r<=0){r+=(this||t).DB;--i}}0!=(128&n)&&(n|=-256);0==o&&(128&(this||t).s)!=(128&n)&&++o;(o>0||n!=(this||t).s)&&(e[o++]=n)}}return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(i){return this.compareTo(i)<0?this||t:i}function bnMax(i){return this.compareTo(i)>0?this||t:i}function bnpBitwiseTo(i,e,r){var n,o,s=Math.min(i.t,(this||t).t);for(n=0;n<s;++n)r[n]=e((this||t)[n],i[n]);if(i.t<(this||t).t){o=i.s&(this||t).DM;for(n=s;n<(this||t).t;++n)r[n]=e((this||t)[n],o);r.t=(this||t).t}else{o=(this||t).s&(this||t).DM;for(n=s;n<i.t;++n)r[n]=e(o,i[n]);r.t=i.t}r.s=e((this||t).s,i.s);r.clamp()}function op_and(t,i){return t&i}function bnAnd(t){var i=nbi();this.bitwiseTo(t,op_and,i);return i}function op_or(t,i){return t|i}function bnOr(t){var i=nbi();this.bitwiseTo(t,op_or,i);return i}function op_xor(t,i){return t^i}function bnXor(t){var i=nbi();this.bitwiseTo(t,op_xor,i);return i}function op_andnot(t,i){return t&~i}function bnAndNot(t){var i=nbi();this.bitwiseTo(t,op_andnot,i);return i}function bnNot(){var i=nbi();for(var e=0;e<(this||t).t;++e)i[e]=(this||t).DM&~(this||t)[e];i.t=(this||t).t;i.s=~(this||t).s;return i}function bnShiftLeft(t){var i=nbi();t<0?this.rShiftTo(-t,i):this.lShiftTo(t,i);return i}function bnShiftRight(t){var i=nbi();t<0?this.lShiftTo(-t,i):this.rShiftTo(t,i);return i}function lbit(t){if(0==t)return-1;var i=0;if(0==(65535&t)){t>>=16;i+=16}if(0==(255&t)){t>>=8;i+=8}if(0==(15&t)){t>>=4;i+=4}if(0==(3&t)){t>>=2;i+=2}0==(1&t)&&++i;return i}function bnGetLowestSetBit(){for(var i=0;i<(this||t).t;++i)if(0!=(this||t)[i])return i*(this||t).DB+lbit((this||t)[i]);return(this||t).s<0?(this||t).t*(this||t).DB:-1}function cbit(t){var i=0;while(0!=t){t&=t-1;++i}return i}function bnBitCount(){var i=0,e=(this||t).s&(this||t).DM;for(var r=0;r<(this||t).t;++r)i+=cbit((this||t)[r]^e);return i}function bnTestBit(i){var e=Math.floor(i/(this||t).DB);return e>=(this||t).t?0!=(this||t).s:0!=((this||t)[e]&1<<i%(this||t).DB)}function bnpChangeBit(t,i){var e=BigInteger.ONE.shiftLeft(t);this.bitwiseTo(e,i,e);return e}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(i,e){var r=0,n=0,o=Math.min(i.t,(this||t).t);while(r<o){n+=(this||t)[r]+i[r];e[r++]=n&(this||t).DM;n>>=(this||t).DB}if(i.t<(this||t).t){n+=i.s;while(r<(this||t).t){n+=(this||t)[r];e[r++]=n&(this||t).DM;n>>=(this||t).DB}n+=(this||t).s}else{n+=(this||t).s;while(r<i.t){n+=i[r];e[r++]=n&(this||t).DM;n>>=(this||t).DB}n+=i.s}e.s=n<0?-1:0;n>0?e[r++]=n:n<-1&&(e[r++]=(this||t).DV+n);e.t=r;e.clamp()}function bnAdd(t){var i=nbi();this.addTo(t,i);return i}function bnSubtract(t){var i=nbi();this.subTo(t,i);return i}function bnMultiply(t){var i=nbi();this.multiplyTo(t,i);return i}function bnDivide(t){var i=nbi();this.divRemTo(t,i,null);return i}function bnRemainder(t){var i=nbi();this.divRemTo(t,null,i);return i}function bnDivideAndRemainder(t){var i=nbi(),e=nbi();this.divRemTo(t,i,e);return new Array(i,e)}function bnpDMultiply(i){(this||t)[(this||t).t]=this.am(0,i-1,this||t,0,0,(this||t).t);++(this||t).t;this.clamp()}function bnpDAddOffset(i,e){if(0!=i){while((this||t).t<=e)(this||t)[(this||t).t++]=0;(this||t)[e]+=i;while((this||t)[e]>=(this||t).DV){(this||t)[e]-=(this||t).DV;++e>=(this||t).t&&((this||t)[(this||t).t++]=0);++(this||t)[e]}}}function NullExp(){}function nNop(t){return t}function nMulTo(t,i,e){t.multiplyTo(i,e)}function nSqrTo(t,i){t.squareTo(i)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(i,e,r){var n=Math.min((this||t).t+i.t,e);r.s=0;r.t=n;while(n>0)r[--n]=0;var o;for(o=r.t-(this||t).t;n<o;++n)r[n+(this||t).t]=this.am(0,i[n],r,n,0,(this||t).t);for(o=Math.min(i.t,e);n<o;++n)this.am(0,i[n],r,n,0,e-n);r.clamp()}function bnpMultiplyUpperTo(i,e,r){--e;var n=r.t=(this||t).t+i.t-e;r.s=0;while(--n>=0)r[n]=0;for(n=Math.max(e-(this||t).t,0);n<i.t;++n)r[(this||t).t+n-e]=this.am(e-n,i[n],r,0,0,(this||t).t+n-e);r.clamp();r.drShiftTo(1,r)}function Barrett(i){(this||t).r2=nbi();(this||t).q3=nbi();BigInteger.ONE.dlShiftTo(2*i.t,(this||t).r2);(this||t).mu=(this||t).r2.divide(i);(this||t).m=i}function barrettConvert(i){if(i.s<0||i.t>2*(this||t).m.t)return i.mod((this||t).m);if(i.compareTo((this||t).m)<0)return i;var e=nbi();i.copyTo(e);this.reduce(e);return e}function barrettRevert(t){return t}function barrettReduce(i){i.drShiftTo((this||t).m.t-1,(this||t).r2);if(i.t>(this||t).m.t+1){i.t=(this||t).m.t+1;i.clamp()}(this||t).mu.multiplyUpperTo((this||t).r2,(this||t).m.t+1,(this||t).q3);(this||t).m.multiplyLowerTo((this||t).q3,(this||t).m.t+1,(this||t).r2);while(i.compareTo((this||t).r2)<0)i.dAddOffset(1,(this||t).m.t+1);i.subTo((this||t).r2,i);while(i.compareTo((this||t).m)>=0)i.subTo((this||t).m,i)}function barrettSqrTo(t,i){t.squareTo(i);this.reduce(i)}function barrettMulTo(t,i,e){t.multiplyTo(i,e);this.reduce(e)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(i,e){var r=i.bitLength(),n,o=nbv(1),s;if(r<=0)return o;n=r<18?1:r<48?3:r<144?4:r<768?5:6;s=r<8?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var h=new Array,a=3,u=n-1,p=(1<<n)-1;h[1]=s.convert(this||t);if(n>1){var l=nbi();s.sqrTo(h[1],l);while(a<=p){h[a]=nbi();s.mulTo(l,h[a-2],h[a]);a+=2}}var f=i.t-1,g,b=true,c=nbi(),v;r=nbits(i[f])-1;while(f>=0){if(r>=u)g=i[f]>>r-u&p;else{g=(i[f]&(1<<r+1)-1)<<u-r;f>0&&(g|=i[f-1]>>(this||t).DB+r-u)}a=n;while(0==(1&g)){g>>=1;--a}if((r-=a)<0){r+=(this||t).DB;--f}if(b){h[g].copyTo(o);b=false}else{while(a>1){s.sqrTo(o,c);s.sqrTo(c,o);a-=2}if(a>0)s.sqrTo(o,c);else{v=o;o=c;c=v}s.mulTo(c,h[g],o)}while(f>=0&&0==(i[f]&1<<r)){s.sqrTo(o,c);v=o;o=c;c=v;if(--r<0){r=(this||t).DB-1;--f}}}return s.revert(o)}function bnGCD(i){var e=(this||t).s<0?this.negate():this.clone();var r=i.s<0?i.negate():i.clone();if(e.compareTo(r)<0){var n=e;e=r;r=n}var o=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;o<s&&(s=o);if(s>0){e.rShiftTo(s,e);r.rShiftTo(s,r)}while(e.signum()>0){(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e);(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r);if(e.compareTo(r)>=0){e.subTo(r,e);e.rShiftTo(1,e)}else{r.subTo(e,r);r.rShiftTo(1,r)}}s>0&&r.lShiftTo(s,r);return r}function bnpModInt(i){if(i<=0)return 0;var e=(this||t).DV%i,r=(this||t).s<0?i-1:0;if((this||t).t>0)if(0==e)r=(this||t)[0]%i;else for(var n=(this||t).t-1;n>=0;--n)r=(e*r+(this||t)[n])%i;return r}function bnModInverse(i){var e=i.isEven();if(this.isEven()&&e||0==i.signum())return BigInteger.ZERO;var r=i.clone(),n=this.clone();var o=nbv(1),s=nbv(0),h=nbv(0),a=nbv(1);while(0!=r.signum()){while(r.isEven()){r.rShiftTo(1,r);if(e){if(!o.isEven()||!s.isEven()){o.addTo(this||t,o);s.subTo(i,s)}o.rShiftTo(1,o)}else s.isEven()||s.subTo(i,s);s.rShiftTo(1,s)}while(n.isEven()){n.rShiftTo(1,n);if(e){if(!h.isEven()||!a.isEven()){h.addTo(this||t,h);a.subTo(i,a)}h.rShiftTo(1,h)}else a.isEven()||a.subTo(i,a);a.rShiftTo(1,a)}if(r.compareTo(n)>=0){r.subTo(n,r);e&&o.subTo(h,o);s.subTo(a,s)}else{n.subTo(r,n);e&&h.subTo(o,h);a.subTo(s,a)}}if(0!=n.compareTo(BigInteger.ONE))return BigInteger.ZERO;if(a.compareTo(i)>=0)return a.subtract(i);if(!(a.signum()<0))return a;a.addTo(i,a);return a.signum()<0?a.add(i):a}var p=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var l=(1<<26)/p[p.length-1];function bnIsProbablePrime(t){var i,e=this.abs();if(1==e.t&&e[0]<=p[p.length-1]){for(i=0;i<p.length;++i)if(e[0]==p[i])return true;return false}if(e.isEven())return false;i=1;while(i<p.length){var r=p[i],n=i+1;while(n<p.length&&r<l)r*=p[n++];r=e.modInt(r);while(i<n)if(r%p[i++]==0)return false}return e.millerRabin(t)}function bnpMillerRabin(i){var e=this.subtract(BigInteger.ONE);var r=e.getLowestSetBit();if(r<=0)return false;var n=e.shiftRight(r);i=i+1>>1;i>p.length&&(i=p.length);var o=nbi();for(var s=0;s<i;++s){o.fromInt(p[s]);var h=o.modPow(n,this||t);if(0!=h.compareTo(BigInteger.ONE)&&0!=h.compareTo(e)){var a=1;while(a++<r&&0!=h.compareTo(e)){h=h.modPowInt(2,this||t);if(0==h.compareTo(BigInteger.ONE))return false}if(0!=h.compareTo(e))return false}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.int2char=int2char;i=BigInteger;var f=i;var g="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var b={};var c;var v;var m;function rng_seed_int(t){v[m++]^=255&t;v[m++]^=t>>8&255;v[m++]^=t>>16&255;v[m++]^=t>>24&255;m>=y&&(m-=y)}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(null==v){v=new Array;m=0;var d;while(m<y){d=Math.floor(65536*Math.random());v[m++]=d>>>8;v[m++]=255&d}m=0;rng_seed_time()}function rng_get_byte(){if(null==c){rng_seed_time();c=prng_newstate();c.init(v);for(m=0;m<v.length;++m)v[m]=0;m=0}return c.next()}function rng_get_bytes(t){var i;for(i=0;i<t.length;++i)t[i]=rng_get_byte()}function SecureRandom(){}function Arcfour(){(this||g).i=0;(this||g).j=0;(this||g).S=new Array}function ARC4init(t){var i,e,r;for(i=0;i<256;++i)(this||g).S[i]=i;e=0;for(i=0;i<256;++i){e=e+(this||g).S[i]+t[i%t.length]&255;r=(this||g).S[i];(this||g).S[i]=(this||g).S[e];(this||g).S[e]=r}(this||g).i=0;(this||g).j=0}function ARC4next(){var t;(this||g).i=(this||g).i+1&255;(this||g).j=(this||g).j+(this||g).S[(this||g).i]&255;t=(this||g).S[(this||g).i];(this||g).S[(this||g).i]=(this||g).S[(this||g).j];(this||g).S[(this||g).j]=t;return(this||g).S[t+(this||g).S[(this||g).i]&255]}function prng_newstate(){return new Arcfour}var y=256;SecureRandom.prototype.nextBytes=rng_get_bytes;Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;b=SecureRandom;var B=b;var T;var I="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var S={};var w=f.int2char;var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var A="=";function hex2b64(t){var i;var e;var r="";for(i=0;i+3<=t.length;i+=3){e=parseInt(t.substring(i,i+3),16);r+=D.charAt(e>>6)+D.charAt(63&e)}if(i+1==t.length){e=parseInt(t.substring(i,i+1),16);r+=D.charAt(e<<2)}else if(i+2==t.length){e=parseInt(t.substring(i,i+2),16);r+=D.charAt(e>>2)+D.charAt((3&e)<<4)}while((3&r.length)>0)r+=A;return r}function b64tohex(t){var i="";var e;var r=0;var n;for(e=0;e<t.length;++e){if(t.charAt(e)==A)break;I.v=T=D.indexOf(t.charAt(e));if(!(T<0))if(0==r){i+=w(T>>2);n=3&T;r=1}else if(1==r){i+=w(n<<2|T>>4);n=15&T;r=2}else if(2==r){i+=w(n);i+=w(T>>2);n=3&T;r=3}else{i+=w(n<<2|T>>4);i+=w(15&T);r=0}}1==r&&(i+=w(n<<2));return i}function b64toBA(t){var i=b64tohex(t);var e;var r=new Array;for(e=0;2*e<i.length;++e)r[e]=parseInt(i.substring(2*e,2*e+2),16);return r}S.hex2b64=hex2b64;S.b64tohex=b64tohex;S.b64toBA=b64toBA;var R="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var M={};var x=f;var E=B;var C=S;function parseBigInt(t,i){return new x(t,i)}function linebrk(t,i){var e="";var r=0;while(r+i<t.length){e+=t.substring(r,r+i)+"\n";r+=i}return e+t.substring(r,t.length)}function byte2Hex(t){return t<16?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,i){if(i<t.length+11){throw new Error("Message too long for RSA (n="+i+", l="+t.length+")");return null}var e=new Array;var r=t.length-1;while(r>=0&&i>0){var n=t.charCodeAt(r--);if(n<128)e[--i]=n;else if(n>127&&n<2048){e[--i]=63&n|128;e[--i]=n>>6|192}else{e[--i]=63&n|128;e[--i]=n>>6&63|128;e[--i]=n>>12|224}}e[--i]=0;var o=new E;var s=new Array;while(i>2){s[0]=0;while(0==s[0])o.nextBytes(s);e[--i]=s[0]}e[--i]=2;e[--i]=0;return new x(e)}function RSAKey(){(this||R).n=null;(this||R).e=0;(this||R).d=null;(this||R).p=null;(this||R).q=null;(this||R).dmp1=null;(this||R).dmq1=null;(this||R).coeff=null}function RSASetPublic(t,i){if(null!=t&&null!=i&&t.length>0&&i.length>0){(this||R).n=parseBigInt(t,16);(this||R).e=parseInt(i,16)}else alert("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt((this||R).e,(this||R).n)}function RSAEncrypt(t){var i=pkcs1pad2(t,(this||R).n.bitLength()+7>>3);if(null==i)return null;var e=this.doPublic(i);if(null==e)return null;var r=e.toString(16);return 0==(1&r.length)?r:"0"+r}function pkcs1unpad2(t,i){var e=t.toByteArray();var r=0;while(r<e.length&&0==e[r])++r;if(e.length-r!=i-1||2!=e[r])return null;++r;while(0!=e[r])if(++r>=e.length)return null;var n="";while(++r<e.length){var o=255&e[r];if(o<128)n+=String.fromCharCode(o);else if(o>191&&o<224){n+=String.fromCharCode((31&o)<<6|63&e[r+1]);++r}else{n+=String.fromCharCode((15&o)<<12|(63&e[r+1])<<6|63&e[r+2]);r+=2}}return n}function RSASetPrivate(t,i,e){if(null!=t&&null!=i&&t.length>0&&i.length>0){(this||R).n=parseBigInt(t,16);(this||R).e=parseInt(i,16);(this||R).d=parseBigInt(e,16)}else alert("Invalid RSA private key")}function RSASetPrivateEx(t,i,e,r,n,o,s,h){if(null!=t&&null!=i&&t.length>0&&i.length>0){(this||R).n=parseBigInt(t,16);(this||R).e=parseInt(i,16);(this||R).d=parseBigInt(e,16);(this||R).p=parseBigInt(r,16);(this||R).q=parseBigInt(n,16);(this||R).dmp1=parseBigInt(o,16);(this||R).dmq1=parseBigInt(s,16);(this||R).coeff=parseBigInt(h,16)}else alert("Invalid RSA private key")}function RSAGenerate(t,i){var e=new E;var r=t>>1;(this||R).e=parseInt(i,16);var n=new x(i,16);for(;;){for(;;){(this||R).p=new x(t-r,1,e);if(0==(this||R).p.subtract(x.ONE).gcd(n).compareTo(x.ONE)&&(this||R).p.isProbablePrime(10))break}for(;;){(this||R).q=new x(r,1,e);if(0==(this||R).q.subtract(x.ONE).gcd(n).compareTo(x.ONE)&&(this||R).q.isProbablePrime(10))break}if((this||R).p.compareTo((this||R).q)<=0){var o=(this||R).p;(this||R).p=(this||R).q;(this||R).q=o}var s=(this||R).p.subtract(x.ONE);var h=(this||R).q.subtract(x.ONE);var a=s.multiply(h);if(0==a.gcd(n).compareTo(x.ONE)){(this||R).n=(this||R).p.multiply((this||R).q);(this||R).d=n.modInverse(a);(this||R).dmp1=(this||R).d.mod(s);(this||R).dmq1=(this||R).d.mod(h);(this||R).coeff=(this||R).q.modInverse((this||R).p);break}}}function RSADoPrivate(t){if(null==(this||R).p||null==(this||R).q)return t.modPow((this||R).d,(this||R).n);var i=t.mod((this||R).p).modPow((this||R).dmp1,(this||R).p);var e=t.mod((this||R).q).modPow((this||R).dmq1,(this||R).q);while(i.compareTo(e)<0)i=i.add((this||R).p);return i.subtract(e).multiply((this||R).coeff).mod((this||R).p).multiply((this||R).q).add(e)}function RSADecrypt(t){var i=parseBigInt(t,16);var e=this.doPrivate(i);return null==e?null:pkcs1unpad2(e,(this||R).n.bitLength()+7>>3)}function baToString(t){var i="";for(var e=0;e<t.length;e++){var r=255&t[e];if(r<128)i+=String.fromCharCode(r);else if(r>191&&r<224){i+=String.fromCharCode((31&r)<<6|63&t[e+1]);++e}else{i+=String.fromCharCode((15&r)<<12|(63&t[e+1])<<6|63&t[e+2]);e+=2}}return i}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;M.Key=RSAKey;M.BigInteger=x;M.linebrk=linebrk;M.byte2Hex=byte2Hex;M.hex2b64=C.hex2b64;M.b64tohex=C.b64tohex;M.b64toBA=C.b64toBA;M.batoString=baToString;const q=M.Key,P=M.BigInteger,N=M.linebrk,O=M.byte2Hex,_=M.hex2b64,L=M.b64tohex,V=M.b64toBA,k=M.batoString;export default M;export{P as BigInteger,q as Key,V as b64toBA,L as b64tohex,k as batoString,O as byte2Hex,_ as hex2b64,N as linebrk};

